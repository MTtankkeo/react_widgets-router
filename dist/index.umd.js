!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react/jsx-runtime"),require("react")):"function"==typeof define&&define.amd?define(["exports","react/jsx-runtime","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactWidgetsRouter={},e.jsxRuntime,e.React)}(this,(function(e,t,n){"use strict";class s{static get pathname(){return location.pathname}static arrayOf(e){return console.assert("A given path does not exist nothing."!=e),Array.from(e.matchAll(/(?<=\/)[\w-]+(?=\/|$)/g)).map((e=>e[0]))}}function o({route:e,active:s,first:o}){const i=n.useRef(s),r=n.useRef(null),a=null==e?void 0:e.props.component,l=null==e?void 0:e.props.element,u=null!=l?l:a?t.jsx(a,{}):t.jsx(t.Fragment,{});return n.useLayoutEffect((()=>{const e=r.current;if(e&&o&&i.current==s)s||(e.style.display="none");else if(e){i.current=s;const t=getComputedStyle(e),n=t.getPropertyValue("--router-fadein-keyframe").replaceAll('"',""),o=t.getPropertyValue("--router-fadein-duration"),r=t.getPropertyValue("--router-fadeout-keyframe").replaceAll('"',""),a=t.getPropertyValue("--router-fadeout-duration");if(s){if(e.style.display="unset",n)return e.style.animation=`${n} ${o||"0.3s"}`,void(e.onanimationend=null)}else{if(r)return e.style.animation=`${r} ${a||"0.3s"}`,void(e.onanimationend=()=>e.style.display="none");e.style.display="none"}}i.current=s}),[s]),t.jsx("route-sliver",{ref:r,children:u})}addEventListener("DOMContentLoaded",(()=>{const e=new CSSStyleSheet;e.insertRule("\n        route-sliver {\n            position: absolute;\n            width: 100%;\n            height: 100%;\n        }\n    "),e.insertRule("\n        *:has(> route-sliver) {\n            position: relative;\n            top: 0px;\n            left: 0px;\n        }\n    "),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}));class i{constructor(){this.listeners=[],window.onpopstate=e=>this.notifyListeners(location.pathname)}static get instance(){var e;return null!==(e=this._instance)&&void 0!==e?e:this._instance=new i}addListener(e){console.assert(!this.listeners.includes(e),"Already exists a given listener in the context."),this.listeners.push(e)}removeListener(e){console.assert(this.listeners.includes(e),"Already not exists a given listener in the context."),this.listeners=this.listeners.filter((t=>t!=e))}notifyListeners(e){this.listeners.forEach((t=>t(e)))}push(e){location.pathname!=e&&(this.notifyListeners(e),history.pushState(null,"",e))}move(e){location.pathname!=e&&(history.replaceState({},"",e),this.notifyListeners(location.pathname))}forward(){history.forward(),this.notifyListeners(location.pathname)}backward(){history.back(),this.notifyListeners(location.pathname)}}class r{constructor(e){this.location=e,this.consumedPath=[],this.paths=[],this.paths=s.arrayOf(e)}get first(){return this.paths[0]}get relPath(){return"/"+this.paths.join("/")}get absPath(){return"/"+this.consumedPath.join("/")+this.paths.join("/")}get clone(){const e=new r(this.location);return e.paths=this.paths,e.consumedPath=this.consumedPath,e}consume(){return console.assert(0!=this.paths.length,"Not exists a path that can be consumed."),this.paths[0]&&this.consumedPath.push(this.paths[0]),this.paths=this.paths.slice(1)}}const a=n.createContext(null);function l(){var e;const t=null!==(e=n.useContext(a))&&void 0!==e?e:new r(window.location.pathname),s=n.useRef(t);return s.current===t?s.current.clone:s.current=t}var u;!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative"}(u||(u={})),e.Route=function(e){var t;return console.assert(null!=e.element||null!=e.component,"Not exists a given component"),console.assert(null==e.element&&null!=e.component,"Cannot define rendering a component."),console.assert(null!=e.element&&null==e.component,"Cannot define rendering a component."),null!==(t=e.component)&&void 0!==t?t:e.element},e.Router=function({location:e,children:l}){const u=n.useRef(new Map),c=function(){let e=n.useContext(a),t=i.instance;if(null==e){const[s,o]=n.useState(window.location.pathname);e=new r(s),t.addListener(o)}return e}(),h=Array.isArray(l)?l:[l];let p=h.find((t=>s.arrayOf(t.props.path)[0]==c.first&&null==e||s.arrayOf(t.props.path)[0]==s.arrayOf(null!=e?e:"")[0]&&e));return p&&0!=c.paths.length&&c.consume(),null!=p||(p=h.find((e=>e.props.default))),p&&u.current.set(p.props.path,{context:c.clone}),t.jsx(t.Fragment,{children:Array.from(u.current).map((([e,n],s)=>{const i=(null==p?void 0:p.props.path)==e,r=h.find((t=>t.props.path==e));return t.jsx(a.Provider,{value:n.context.clone,children:t.jsx(o,{active:i,first:0==s,route:r},e)})}))})},e.RouterBinding=i,e.RouterContext=r,e.useLocation=l,e.useRouter=function(e){var t;const n=null!==(t=null==e?void 0:e.context)&&void 0!==t?t:l();return t=>{var s,o,r;const a=null!==(s=null==e?void 0:e.routing)&&void 0!==s?s:u.relative,l=t.startsWith("/")?t.slice(1):t;a==u.absolute?null!==(o=null==e?void 0:e.replace)&&void 0!==o&&o?i.instance.move(t):i.instance.push(t):null!==(r=null==e?void 0:e.replace)&&void 0!==r&&r?i.instance.move("/"+[...n.consumedPath,l].join("/")):i.instance.push("/"+[...n.consumedPath,l].join("/"))}}}));
