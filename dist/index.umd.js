!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react/jsx-runtime"),require("react")):"function"==typeof define&&define.amd?define(["exports","react/jsx-runtime","react"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ReactWidgetsRouter={},t.jsxRuntime,t.React)}(this,(function(t,e,n){"use strict";class s{static get pathname(){return location.pathname}static arrayOf(t){return console.assert("A given path does not exist nothing."!=t),Array.from(t.matchAll(/(?<=\/)[\w-]+(?=\/|$)/g)).map((t=>t[0]))}}class o{constructor(t){this.location=t,this.consumedPath=[],this.paths=[],this.paths=s.arrayOf(t)}get first(){return this.paths[0]}get relPath(){return"/"+this.paths.join("/")}get absPath(){return"/"+this.consumedPath.join("/")+this.paths.join("/")}get clone(){const t=new o(this.location);return t.paths=this.paths,t.consumedPath=this.consumedPath,t}consume(){return console.assert(0!=this.paths.length,"Not exists a path that can be consumed."),this.paths[0]&&this.consumedPath.push(this.paths[0]),this.paths=this.paths.slice(1)}}class i{constructor(){this.listeners=[],window.onpopstate=t=>this.notifyListeners(location.pathname)}static get instance(){var t;return null!==(t=this._instance)&&void 0!==t?t:this._instance=new i}addListener(t){console.assert(!this.listeners.includes(t),"Already exists a given listener in the context."),this.listeners.push(t)}removeListener(t){console.assert(this.listeners.includes(t),"Already not exists a given listener in the context."),this.listeners=this.listeners.filter((e=>e!=t))}notifyListeners(t){this.listeners.forEach((e=>e(t)))}push(t){location.pathname!=t&&(this.notifyListeners(t),history.pushState(null,"",t))}move(t){location.pathname!=t&&(history.replaceState({},"",t),this.notifyListeners(location.pathname))}forward(){history.forward(),this.notifyListeners(location.pathname)}backward(){history.back(),this.notifyListeners(location.pathname)}}function r(){let t=n.useContext(l),e=i.instance;if(null==t){const[s,i]=n.useState(window.location.pathname);t=new o(s),e.addListener((t=>{i(t)}))}return t}function a({route:t,active:s,first:o}){const i=n.useRef(s),r=n.useRef(null),a=null==t?void 0:t.props.component,l=null==t?void 0:t.props.element,u=null!=l?l:a?e.jsx(a,{}):e.jsx(e.Fragment,{});return n.useLayoutEffect((()=>{const t=r.current;if(t&&o&&i.current==s)s||(t.style.display="none");else if(t){i.current=s;const e=getComputedStyle(t),n=e.getPropertyValue("--router-fadein-keyframe").replaceAll('"',""),o=e.getPropertyValue("--router-fadein-duration"),r=e.getPropertyValue("--router-fadeout-keyframe").replaceAll('"',""),a=e.getPropertyValue("--router-fadeout-duration");if(s){if(t.style.display="unset",n)return t.style.animation=`${n} ${o||"0.3s"}`,void(t.onanimationend=null)}else{if(r)return t.style.animation=`${r} ${a||"0.3s"}`,void(t.onanimationend=()=>t.style.display="none");t.style.display="none"}}i.current=s}),[s]),e.jsx("route-sliver",{ref:r,children:u})}addEventListener("DOMContentLoaded",(()=>{const t=new CSSStyleSheet;t.insertRule("\n        route-sliver {\n            position: absolute;\n            width: 100%;\n            height: 100%;\n        }\n    "),t.insertRule("\n        *:has(> route-sliver) {\n            position: relative;\n            top: 0px;\n            left: 0px;\n        }\n    "),document.adoptedStyleSheets=[...document.adoptedStyleSheets,t]}));const l=n.createContext(null);var u;!function(t){t[t.absolute=0]="absolute",t[t.relative=1]="relative"}(u||(u={})),t.Route=function(t){var e;return console.assert(null!=t.element||null!=t.component,"Not exists a given component"),console.assert(null==t.element&&null!=t.component,"Cannot define rendering a component."),console.assert(null!=t.element&&null==t.component,"Cannot define rendering a component."),null!==(e=t.component)&&void 0!==e?e:t.element},t.Router=function({location:t,children:o}){const i=n.useRef(new Map),u=r(),c=Array.isArray(o)?o:[o];let h=c.find((e=>s.arrayOf(e.props.path)[0]==u.first&&null==t||s.arrayOf(e.props.path)[0]==s.arrayOf(null!=t?t:"")[0]&&t));return h&&0!=u.paths.length&&u.consume(),null!=h||(h=c.find((t=>t.props.default))),h&&i.current.set(h.props.path,{context:u.clone}),e.jsx(e.Fragment,{children:Array.from(i.current).map((([t,n],s)=>{const o=(null==h?void 0:h.props.path)==t,i=c.find((e=>e.props.path==t));return e.jsx(l.Provider,{value:n.context.clone,children:e.jsx(a,{active:o,first:0==s,route:i},t)})}))})},t.RouterBinding=i,t.RouterContext=o,t.useLocation=r,t.useRoute=function(t){var e;const n=null!==(e=null==t?void 0:t.context)&&void 0!==e?e:r();return e=>{var s;const o=null!==(s=null==t?void 0:t.routing)&&void 0!==s?s:u.relative,r=e.startsWith("/")?e.slice(1):e;o==u.absolute?i.instance.push(e):i.instance.push("/"+[...n.consumedPath,r].join("/"))}}}));
